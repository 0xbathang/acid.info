"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
const tslib_1 = require("tslib");
const lsd_react_1 = require("@acid-info/lsd-react");
const theme_common_1 = require("@docusaurus/theme-common");
const internal_1 = require("@docusaurus/theme-common/internal");
const NavbarItem_1 = tslib_1.__importDefault(require("@theme/NavbarItem"));
const NavbarNavLink_1 = tslib_1.__importDefault(require("@theme/NavbarItem/NavbarNavLink"));
const clsx_1 = tslib_1.__importDefault(require("clsx"));
const react_1 = tslib_1.__importStar(require("react"));
const styles_module_scss_1 = tslib_1.__importDefault(require("./styles.module.scss"));
function isItemActive(item, localPathname) {
    if ((0, internal_1.isSamePath)(item.to, localPathname)) {
        return true;
    }
    if ((0, theme_common_1.isRegexpStringMatch)(item.activeBaseRegex, localPathname)) {
        return true;
    }
    if (item.activeBasePath && localPathname.startsWith(item.activeBasePath)) {
        return true;
    }
    return false;
}
function containsActiveItems(items, localPathname) {
    return items.some((item) => isItemActive(item, localPathname));
}
function DropdownNavbarItemDesktop({ items, position, className, onClick, ...props }) {
    const dropdownRef = (0, react_1.useRef)(null);
    const [showDropdown, setShowDropdown] = (0, react_1.useState)(false);
    (0, react_1.useEffect)(() => {
        const handleClickOutside = (event) => {
            if (!dropdownRef.current || dropdownRef.current.contains(event.target)) {
                return;
            }
            setShowDropdown(false);
        };
        document.addEventListener('mousedown', handleClickOutside);
        document.addEventListener('touchstart', handleClickOutside);
        document.addEventListener('focusin', handleClickOutside);
        return () => {
            document.removeEventListener('mousedown', handleClickOutside);
            document.removeEventListener('touchstart', handleClickOutside);
            document.removeEventListener('focusin', handleClickOutside);
        };
    }, [dropdownRef]);
    return (react_1.default.createElement("div", { ref: dropdownRef, className: (0, clsx_1.default)('navbar__item', styles_module_scss_1.default.dropdownNavbarItem, 'dropdown', 'dropdown--hoverable', {
            'dropdown--right': position === 'right',
            'dropdown--show': showDropdown,
        }) },
        react_1.default.createElement(NavbarNavLink_1.default, { "aria-haspopup": "true", "aria-expanded": showDropdown, role: "button", href: props.to ? undefined : '#', className: (0, clsx_1.default)('navbar__link', className), ...props, onClick: props.to ? undefined : (e) => e.preventDefault(), onKeyDown: (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    setShowDropdown(!showDropdown);
                }
            } }, props.children ?? props.label),
        react_1.default.createElement(lsd_react_1.ArrowDownIcon, { className: (0, clsx_1.default)('margin-left-8', 'cursor-pointer') }),
        react_1.default.createElement("ul", { className: "dropdown__menu" }, items.map((childItemProps, i) => (react_1.default.createElement(NavbarItem_1.default, { isDropdownItem: true, activeClassName: "dropdown__link--active", ...childItemProps, key: i }))))));
}
function DropdownNavbarItemMobile({ items, className, position, // Need to destructure position from props so that it doesn't get passed on.
onClick, ...props }) {
    const localPathname = (0, internal_1.useLocalPathname)();
    const containsActive = containsActiveItems(items, localPathname);
    const { collapsed, toggleCollapsed, setCollapsed } = (0, theme_common_1.useCollapsible)({
        initialState: () => !containsActive,
    });
    // Expand/collapse if any item active after a navigation
    (0, react_1.useEffect)(() => {
        if (containsActive) {
            setCollapsed(!containsActive);
        }
    }, [localPathname, containsActive, setCollapsed]);
    return (react_1.default.createElement("li", { className: (0, clsx_1.default)('menu__list-item', {
            'menu__list-item--collapsed': collapsed,
        }) },
        react_1.default.createElement(NavbarNavLink_1.default, { role: "button", className: (0, clsx_1.default)('menu__link menu__link--sublist menu__link--sublist-caret', className), ...props, onClick: (e) => {
                e.preventDefault();
                toggleCollapsed();
            } },
            react_1.default.createElement(lsd_react_1.Typography, { variant: "body1" }, props.children ?? props.label)),
        react_1.default.createElement(theme_common_1.Collapsible, { lazy: true, as: "ul", className: "menu__list", collapsed: collapsed }, items.map((childItemProps, i) => (react_1.default.createElement(NavbarItem_1.default, { mobile: true, isDropdownItem: true, onClick: onClick, activeClassName: "menu__link--active", ...childItemProps, key: i }))))));
}
function DropdownNavbarItem({ mobile = false, ...props }) {
    const Comp = mobile ? DropdownNavbarItemMobile : DropdownNavbarItemDesktop;
    //@ts-ignore
    return react_1.default.createElement(Comp, { ...props });
}
exports.default = DropdownNavbarItem;

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9jbGllbnQvdGhlbWUvTmF2YmFySXRlbS9Ecm9wZG93bk5hdmJhckl0ZW0vaW5kZXgudHN4Il0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7OztBQUFBLG9EQUEwRTtBQUMxRSwyREFJaUM7QUFDakMsZ0VBQWdGO0FBQ2hGLDJFQUEwQztBQUMxQyw0RkFBMkQ7QUFDM0Qsd0RBQXVCO0FBQ3ZCLHVEQUEwRDtBQUMxRCxzRkFBeUM7QUFFekMsU0FBUyxZQUFZLENBQUMsSUFBSSxFQUFFLGFBQWE7SUFDdkMsSUFBSSxJQUFBLHFCQUFVLEVBQUMsSUFBSSxDQUFDLEVBQUUsRUFBRSxhQUFhLENBQUMsRUFBRTtRQUN0QyxPQUFPLElBQUksQ0FBQTtLQUNaO0lBQ0QsSUFBSSxJQUFBLGtDQUFtQixFQUFDLElBQUksQ0FBQyxlQUFlLEVBQUUsYUFBYSxDQUFDLEVBQUU7UUFDNUQsT0FBTyxJQUFJLENBQUE7S0FDWjtJQUNELElBQUksSUFBSSxDQUFDLGNBQWMsSUFBSSxhQUFhLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsRUFBRTtRQUN4RSxPQUFPLElBQUksQ0FBQTtLQUNaO0lBQ0QsT0FBTyxLQUFLLENBQUE7QUFDZCxDQUFDO0FBRUQsU0FBUyxtQkFBbUIsQ0FBQyxLQUFLLEVBQUUsYUFBYTtJQUMvQyxPQUFPLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLFlBQVksQ0FBQyxJQUFJLEVBQUUsYUFBYSxDQUFDLENBQUMsQ0FBQTtBQUNoRSxDQUFDO0FBRUQsU0FBUyx5QkFBeUIsQ0FBQyxFQUNqQyxLQUFLLEVBQ0wsUUFBUSxFQUNSLFNBQVMsRUFDVCxPQUFPLEVBQ1AsR0FBRyxLQUFLLEVBQ1Q7SUFDQyxNQUFNLFdBQVcsR0FBRyxJQUFBLGNBQU0sRUFBaUIsSUFBSSxDQUFDLENBQUE7SUFDaEQsTUFBTSxDQUFDLFlBQVksRUFBRSxlQUFlLENBQUMsR0FBRyxJQUFBLGdCQUFRLEVBQUMsS0FBSyxD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QUFFLE9BQU8sRUFDaEIsZUFBZSxFQUFDLG9CQUFvQixLQUNoQyxjQUFjLEVBQ2xCLEdBQUcsRUFBRSxDQUFDLEdBQ04sQ0FDSCxDQUFDLENBQ1UsQ0FDWCxDQUNOLENBQUE7QUFDSCxDQUFDO0FBQ0QsU0FBd0Isa0JBQWtCLENBQUMsRUFBRSxNQUFNLEdBQUcsS0FBSyxFQUFFLEdBQUcsS0FBSyxFQUFFO0lBQ3JFLE1BQU0sSUFBSSxHQUFHLE1BQU0sQ0FBQyxDQUFDLENBQUMsd0JBQXdCLENBQUMsQ0FBQyxDQUFDLHlCQUF5QixDQUFBO0lBRTFFLFlBQVk7SUFDWixPQUFPLDhCQUFDLElBQUksT0FBSyxLQUFLLEdBQUksQ0FBQTtBQUM1QixDQUFDO0FBTEQscUNBS0MiLCJmaWxlIjoiY2xpZW50L3RoZW1lL05hdmJhckl0ZW0vRHJvcGRvd25OYXZiYXJJdGVtL2luZGV4LmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQXJyb3dEb3duSWNvbiwgRHJvcGRvd24sIFR5cG9ncmFwaHkgfSBmcm9tICdAYWNpZC1pbmZvL2xzZC1yZWFjdCdcbmltcG9ydCB7XG4gIENvbGxhcHNpYmxlLFxuICBpc1JlZ2V4cFN0cmluZ01hdGNoLFxuICB1c2VDb2xsYXBzaWJsZSxcbn0gZnJvbSAnQGRvY3VzYXVydXMvdGhlbWUtY29tbW9uJ1xuaW1wb3J0IHsgaXNTYW1lUGF0aCwgdXNlTG9jYWxQYXRobmFtZSB9IGZyb20gJ0Bkb2N1c2F1cnVzL3RoZW1lLWNvbW1vbi9pbnRlcm5hbCdcbmltcG9ydCBOYXZiYXJJdGVtIGZyb20gJ0B0aGVtZS9OYXZiYXJJdGVtJ1xuaW1wb3J0IE5hdmJhck5hdkxpbmsgZnJvbSAnQHRoZW1lL05hdmJhckl0ZW0vTmF2YmFyTmF2TGluaydcbmltcG9ydCBjbHN4IGZyb20gJ2Nsc3gnXG5pbXBvcnQgUmVhY3QsIHsgdXNlRWZmZWN0LCB1c2VSZWYsIHVzZVN0YXRlIH0gZnJvbSAncmVhY3QnXG5pbXBvcnQgc3R5bGVzIGZyb20gJy4vc3R5bGVzLm1vZHVsZS5zY3NzJ1xuXG5mdW5jdGlvbiBpc0l0ZW1BY3RpdmUoaXRlbSwgbG9jYWxQYXRobmFtZSkge1xuICBpZiAoaXNTYW1lUGF0aChpdGVtLnRvLCBsb2NhbFBhdGhuYW1lKSkge1xuICAgIHJldHVybiB0cnVlXG4gIH1cbiAgaWYgKGlzUmVnZXhwU3RyaW5nTWF0Y2goaXRlbS5hY3RpdmVCYXNlUmVnZXgsIGxvY2FsUGF0aG5hbWUpKSB7XG4gICAgcmV0dXJuIHRydWVcbiAgfVxuICBpZiAoaXRlbS5hY3RpdmVCYXNlUGF0aCAmJiBsb2NhbFBhdGhuYW1lLnN0YXJ0c1dpdGgoaXRlbS5hY3RpdmVCYXNlUGF0aCkpIHtcbiAgICByZXR1cm4gdHJ1ZVxuICB9XG4gIHJldHVybiBmYWxzZVxufVxuXG5mdW5jdGlvbiBjb250YWluc0FjdGl2ZUl0ZW1zKGl0ZW1zLCBsb2NhbFBhdGhuYW1lKSB7XG4gIHJldHVybiBpdGVtcy5zb21lKChpdGVtKSA9PiBpc0l0ZW1BY3RpdmUoaXRlbSwgbG9jYWxQYXRobmFtZSkpXG59XG5cbmZ1bmN0aW9uIERyb3Bkb3duTmF2YmFySXRlbURlc2t0b3Aoe1xuICBpdGVtcyxcbiAgcG9zaXRpb24sXG4gIGNsYXNzTmFtZSxcbiAgb25DbGljayxcbiAgLi4ucHJvcHNcbn0pIHtcbiAgY29uc3QgZHJvcGRvd25SZWYgPSB1c2VSZWY8SFRNTERpdkVsZW1lbnQ+KG51bGwpXG4gIGNvbnN0IFtzaG93RHJvcGRvd24sIHNldFNob3dEcm9wZG93bl0gPSB1c2VTdGF0ZShmYWxzZSlcblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGNvbnN0IGhhbmRsZUNsaWNrT3V0c2lkZSA9IChldmVudCkgPT4ge1xuICAgICAgaWYgKCFkcm9wZG93blJlZi5jdXJyZW50IHx8IGRyb3Bkb3duUmVmLmN1cnJlbnQuY29udGFpbnMoZXZlbnQudGFyZ2V0KSkge1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cbiAgICAgIHNldFNob3dEcm9wZG93bihmYWxzZSlcbiAgICB9XG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgaGFuZGxlQ2xpY2tPdXRzaWRlKVxuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNoc3RhcnQnLCBoYW5kbGVDbGlja091dHNpZGUpXG4gICAgZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignZm9jdXNpbicsIGhhbmRsZUNsaWNrT3V0c2lkZSlcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgaGFuZGxlQ2xpY2tPdXRzaWRlKVxuICAgICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2hzdGFydCcsIGhhbmRsZUNsaWNrT3V0c2lkZSlcbiAgICAgIGRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2ZvY3VzaW4nLCBoYW5kbGVDbGlja091dHNpZGUpXG4gICAgfVxuICB9LCBbZHJvcGRvd25SZWZdKVxuXG4gIHJldHVybiAoXG4gICAgPGRpdlxuICAgICAgcmVmPXtkcm9wZG93blJlZn1cbiAgICAgIGNsYXNzTmFtZT17Y2xzeChcbiAgICAgICAgJ25hdmJhcl9faXRlbScsXG4gICAgICAgIHN0eWxlcy5kcm9wZG93bk5hdmJhckl0ZW0sXG4gICAgICAgICdkcm9wZG93bicsXG4gICAgICAgICdkcm9wZG93bi0taG92ZXJhYmxlJyxcbiAgICAgICAge1xuICAgICAgICAgICdkcm9wZG93bi0tcmlnaHQnOiBwb3NpdGlvbiA9PT0gJ3JpZ2h0JyxcbiAgICAgICAgICAnZHJvcGRvd24tLXNob3cnOiBzaG93RHJvcGRvd24sXG4gICAgICAgIH0sXG4gICAgICApfVxuICAgID5cbiAgICAgIDxOYXZiYXJOYXZMaW5rXG4gICAgICAgIGFyaWEtaGFzcG9wdXA9XCJ0cnVlXCJcbiAgICAgICAgYXJpYS1leHBhbmRlZD17c2hvd0Ryb3Bkb3dufVxuICAgICAgICByb2xlPVwiYnV0dG9uXCJcbiAgICAgICAgaHJlZj17cHJvcHMudG8gPyB1bmRlZmluZWQgOiAnIyd9XG4gICAgICAgIGNsYXNzTmFtZT17Y2xzeCgnbmF2YmFyX19saW5rJywgY2xhc3NOYW1lKX1cbiAgICAgICAgey4uLnByb3BzfVxuICAgICAgICBvbkNsaWNrPXtwcm9wcy50byA/IHVuZGVmaW5lZCA6IChlKSA9PiBlLnByZXZlbnREZWZhdWx0KCl9XG4gICAgICAgIG9uS2V5RG93bj17KGUpID0+IHtcbiAgICAgICAgICBpZiAoZS5rZXkgPT09ICdFbnRlcicpIHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKVxuICAgICAgICAgICAgc2V0U2hvd0Ryb3Bkb3duKCFzaG93RHJvcGRvd24pXG4gICAgICAgICAgfVxuICAgICAgICB9fVxuICAgICAgPlxuICAgICAgICB7cHJvcHMuY2hpbGRyZW4gPz8gcHJvcHMubGFiZWx9XG4gICAgICA8L05hdmJhck5hdkxpbms+XG4gICAgICA8QXJyb3dEb3duSWNvbiBjbGFzc05hbWU9e2Nsc3goJ21hcmdpbi1sZWZ0LTgnLCAnY3Vyc29yLXBvaW50ZXInKX0gLz5cbiAgICAgIDx1bCBjbGFzc05hbWU9XCJkcm9wZG93bl9fbWVudVwiPlxuICAgICAgICB7aXRlbXMubWFwKChjaGlsZEl0ZW1Qcm9wcywgaSkgPT4gKFxuICAgICAgICAgIDxOYXZiYXJJdGVtXG4gICAgICAgICAgICBpc0Ryb3Bkb3duSXRlbVxuICAgICAgICAgICAgYWN0aXZlQ2xhc3NOYW1lPVwiZHJvcGRvd25fX2xpbmstLWFjdGl2ZVwiXG4gICAgICAgICAgICB7Li4uY2hpbGRJdGVtUHJvcHN9XG4gICAgICAgICAgICBrZXk9e2l9XG4gICAgICAgICAgLz5cbiAgICAgICAgKSl9XG4gICAgICA8L3VsPlxuICAgIDwvZGl2PlxuICApXG59XG5cbmZ1bmN0aW9uIERyb3Bkb3duTmF2YmFySXRlbU1vYmlsZSh7XG4gIGl0ZW1zLFxuICBjbGFzc05hbWUsXG4gIHBvc2l0aW9uLCAvLyBOZWVkIHRvIGRlc3RydWN0dXJlIHBvc2l0aW9uIGZyb20gcHJvcHMgc28gdGhhdCBpdCBkb2Vzbid0IGdldCBwYXNzZWQgb24uXG4gIG9uQ2xpY2ssXG4gIC4uLnByb3BzXG59KSB7XG4gIGNvbnN0IGxvY2FsUGF0aG5hbWUgPSB1c2VMb2NhbFBhdGhuYW1lKClcbiAgY29uc3QgY29udGFpbnNBY3RpdmUgPSBjb250YWluc0FjdGl2ZUl0ZW1zKGl0ZW1zLCBsb2NhbFBhdGhuYW1lKVxuICBjb25zdCB7IGNvbGxhcHNlZCwgdG9nZ2xlQ29sbGFwc2VkLCBzZXRDb2xsYXBzZWQgfSA9IHVzZUNvbGxhcHNpYmxlKHtcbiAgICBpbml0aWFsU3RhdGU6ICgpID0+ICFjb250YWluc0FjdGl2ZSxcbiAgfSlcblxuICAvLyBFeHBhbmQvY29sbGFwc2UgaWYgYW55IGl0ZW0gYWN0aXZlIGFmdGVyIGEgbmF2aWdhdGlvblxuICB1c2VFZmZlY3QoKCkgPT4ge1xuICAgIGlmIChjb250YWluc0FjdGl2ZSkge1xuICAgICAgc2V0Q29sbGFwc2VkKCFjb250YWluc0FjdGl2ZSlcbiAgICB9XG4gIH0sIFtsb2NhbFBhdGhuYW1lLCBjb250YWluc0FjdGl2ZSwgc2V0Q29sbGFwc2VkXSlcbiAgcmV0dXJuIChcbiAgICA8bGlcbiAgICAgIGNsYXNzTmFtZT17Y2xzeCgnbWVudV9fbGlzdC1pdGVtJywge1xuICAgICAgICAnbWVudV9fbGlzdC1pdGVtLS1jb2xsYXBzZWQnOiBjb2xsYXBzZWQsXG4gICAgICB9KX1cbiAgICA+XG4gICAgICA8TmF2YmFyTmF2TGlua1xuICAgICAgICByb2xlPVwiYnV0dG9uXCJcbiAgICAgICAgY2xhc3NOYW1lPXtjbHN4KFxuICAgICAgICAgICdtZW51X19saW5rIG1lbnVfX2xpbmstLXN1Ymxpc3QgbWVudV9fbGluay0tc3VibGlzdC1jYXJldCcsXG4gICAgICAgICAgY2xhc3NOYW1lLFxuICAgICAgICApfVxuICAgICAgICB7Li4ucHJvcHN9XG4gICAgICAgIG9uQ2xpY2s9eyhlKSA9PiB7XG4gICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpXG4gICAgICAgICAgdG9nZ2xlQ29sbGFwc2VkKClcbiAgICAgICAgfX1cbiAgICAgID5cbiAgICAgICAgPFR5cG9ncmFwaHkgdmFyaWFudD1cImJvZHkxXCI+e3Byb3BzLmNoaWxkcmVuID8/IHByb3BzLmxhYmVsfTwvVHlwb2dyYXBoeT5cbiAgICAgIDwvTmF2YmFyTmF2TGluaz5cbiAgICAgIDxDb2xsYXBzaWJsZSBsYXp5IGFzPVwidWxcIiBjbGFzc05hbWU9XCJtZW51X19saXN0XCIgY29sbGFwc2VkPXtjb2xsYXBzZWR9PlxuICAgICAgICB7aXRlbXMubWFwKChjaGlsZEl0ZW1Qcm9wcywgaSkgPT4gKFxuICAgICAgICAgIDxOYXZiYXJJdGVtXG4gICAgICAgICAgICBtb2JpbGVcbiAgICAgICAgICAgIGlzRHJvcGRvd25JdGVtXG4gICAgICAgICAgICBvbkNsaWNrPXtvbkNsaWNrfVxuICAgICAgICAgICAgYWN0aXZlQ2xhc3NOYW1lPVwibWVudV9fbGluay0tYWN0aXZlXCJcbiAgICAgICAgICAgIHsuLi5jaGlsZEl0ZW1Qcm9wc31cbiAgICAgICAgICAgIGtleT17aX1cbiAgICAgICAgICAvPlxuICAgICAgICApKX1cbiAgICAgIDwvQ29sbGFwc2libGU+XG4gICAgPC9saT5cbiAgKVxufVxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gRHJvcGRvd25OYXZiYXJJdGVtKHsgbW9iaWxlID0gZmFsc2UsIC4uLnByb3BzIH0pIHtcbiAgY29uc3QgQ29tcCA9IG1vYmlsZSA/IERyb3Bkb3duTmF2YmFySXRlbU1vYmlsZSA6IERyb3Bkb3duTmF2YmFySXRlbURlc2t0b3BcblxuICAvL0B0cy1pZ25vcmVcbiAgcmV0dXJuIDxDb21wIHsuLi5wcm9wc30gLz5cbn1cbiJdfQ==
